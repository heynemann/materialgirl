<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Materialgirl by heynemann</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/heynemann/materialgirl">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/heynemann/materialgirl/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/heynemann/materialgirl/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Materialgirl</h1>
          <p>MaterialGirl is a library to keep materialized views and consolidations up-to-date.</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/heynemann">heynemann</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a name="materialgirl" class="anchor" href="#materialgirl"><span class="octicon octicon-link"></span></a>MaterialGirl</h1>

<p>MaterialGirl is a library to keep materialized views and consolidations up-to-date.</p>

<h1>
<a name="installing" class="anchor" href="#installing"><span class="octicon octicon-link"></span></a>Installing</h1>

<p>Intalling it is as easy as::</p>

<pre><code>$ pip install materialgirl
</code></pre>

<h1>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h1>

<p>MaterialGirl can be used to keep a set of data, called "materials", up-to-date.</p>

<p>It is very useful to keep slow queries or consolidated data fast to get.</p>

<p>You also need to select a storage (more on storages later). MaterialGirl comes bundled with two storages:</p>

<ul>
<li>materialgirl.storage.memory.InMemoryStorage</li>
<li>materialgirl.storage.redis.RedisStorage</li>
</ul><p>Using MaterialGirl:</p>

<pre><code>from materialgirl import Materializer
from materialgirl.storage.memory import InMemoryStorage

def get_very_slow_data():
    return "this is very slow to get"

storage = InMemoryStorage()
girl = Materializer(storage=storage)

girl.add_material(
    'my-very-slow-data-key',
    get_very_slow_data,  # this should be the function to get up-to-date data
    120  # the expiration in seconds
)

girl.run()  # this updates all the expired materials and should be run in a loop
</code></pre>

<p>To run the loop you can use whatever daemon, worker, runner solution you'd like. We recommend <a href="http://heynemann.github.io/sheep/">Sheep</a>.</p>

<h1>
<a name="retrieving-up-to-date-information" class="anchor" href="#retrieving-up-to-date-information"><span class="octicon octicon-link"></span></a>Retrieving Up-To-Date Information</h1>

<p>Whenever you need to get the up-to-date information you set with material girl, just call the get method on an instance with the
same materials as the one you are running to update the data, like this:</p>

<pre><code>from materialgirl import Materializer
from materialgirl.storage.memory import InMemoryStorage

def get_very_slow_data():
    return "this is very slow to get"

storage = InMemoryStorage()
girl = Materializer(storage=storage)

girl.add_material(
    'my-very-slow-data-key',
    get_very_slow_data,  # this should be the function to get up-to-date data
    120  # the expiration in seconds
)

assert girl.get('my-very-slow-data-key') == 'this is very slow to get'
</code></pre>

<p>MaterialGirl is lazy. If it has not the up-to-date value in storage to give you, it will call your get method, update the storage and return the proper value.</p>

<h1>
<a name="storages" class="anchor" href="#storages"><span class="octicon octicon-link"></span></a>Storages</h1>

<p>The in-memory storage is more of a proof of concept and should only be used for very simple scenarios as it stores the data in-process.</p>

<h2>
<a name="redis-storage" class="anchor" href="#redis-storage"><span class="octicon octicon-link"></span></a>Redis Storage</h2>

<p>The redis storage takes one parameter: a redis connection.</p>

<pre><code>import redis
from materialgirl.storage.redis import RedisStorage

storage = RedisStorage(redis=redis.StrictRedis())
</code></pre>

<h2>
<a name="creating-a-custom-storage" class="anchor" href="#creating-a-custom-storage"><span class="octicon octicon-link"></span></a>Creating a Custom Storage</h2>

<p>Creating a custom storage is as simple as implementing two methods: <code>store</code> and <code>retrieve</code>:</p>

<pre><code>from materialgirl.storage import Storage

class MyCustomStorage(Storage):
    def store(self, key, value, expiration=None):
        # store the value somewhere under `key`

    def get(self, key):
        # retrieve the value for `key` from same storage solution
</code></pre>

<h1>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h1>

<p>Just fork, commit, pull request our way.</p>

<h1>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h1>

<p>MIT licensed.</p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-48973824-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>